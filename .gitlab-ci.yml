include:
  - project: 'common/gitlab-ci'
    ref: v0.4.12
    file: '/templates/npm-package-with-container.yml'

npm-package-build:
  image: registry.kyso.io/kyso-io/kyso-cli:builder-v1.0.0
  before_script:
    - mv /root/node_modules .

npm-package-publish:
  image: registry.kyso.io/kyso-io/kyso-cli:builder-v1.0.0
  before_script:
    - mv /root/node_modules .
    - !reference [.git-config, before_script]
    - !reference [.npm-config, before_script]

docker-build:
  dependencies:
    - npm-package-publish

variables:
  DOCKER_BUILDKIT: 1
